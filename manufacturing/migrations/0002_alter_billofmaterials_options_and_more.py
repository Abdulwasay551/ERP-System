# Generated by Django 5.2.4 on 2025-08-03 09:39

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('crm', '0002_partner_agreement_contract_partner_annual_revenue_and_more'),
        ('inventory', '0004_stocklot_quarantine_reason'),
        ('manufacturing', '0001_initial'),
        ('products', '0004_product_auto_reorder_product_bill_of_materials_and_more'),
        ('sales', '0004_remove_invoiceitem_discount_percent_and_more'),
        ('user_auth', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AlterModelOptions(
            name='billofmaterials',
            options={'ordering': ['-is_default', '-version']},
        ),
        migrations.AlterModelOptions(
            name='billofmaterialsitem',
            options={'ordering': ['sequence', 'component__name']},
        ),
        migrations.AlterModelOptions(
            name='productionplan',
            options={'ordering': ['-start_date']},
        ),
        migrations.AlterModelOptions(
            name='workorder',
            options={'ordering': ['-created_at']},
        ),
        migrations.RemoveField(
            model_name='workorder',
            name='quantity',
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='effective_from',
            field=models.DateField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='effective_to',
            field=models.DateField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='is_active',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='is_default',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='labor_cost',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=15),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='lead_time_days',
            field=models.IntegerField(default=1),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='lot_size',
            field=models.DecimalField(decimal_places=2, default=1, max_digits=12),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='manufacturing_type',
            field=models.CharField(choices=[('make_to_stock', 'Make to Stock'), ('make_to_order', 'Make to Order'), ('engineer_to_order', 'Engineer to Order'), ('assemble_to_order', 'Assemble to Order')], default='make_to_stock', max_length=20),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='material_cost',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=15),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='overhead_cost',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=15),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='phantom_bom',
            field=models.BooleanField(default=False, help_text='Used for intermediate assemblies'),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='quality_check_required',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='quality_specification',
            field=models.TextField(blank=True),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='revision',
            field=models.CharField(blank=True, max_length=50),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='routing_required',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='scrap_percentage',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=5, validators=[django.core.validators.MinValueValidator(0)]),
        ),
        migrations.AddField(
            model_name='billofmaterials',
            name='total_cost',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=15),
        ),
        migrations.AddField(
            model_name='billofmaterialsitem',
            name='created_at',
            field=models.DateTimeField(auto_now_add=True, default=django.utils.timezone.now),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='billofmaterialsitem',
            name='effective_quantity',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=12),
        ),
        migrations.AddField(
            model_name='billofmaterialsitem',
            name='is_optional',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='billofmaterialsitem',
            name='preferred_supplier',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='preferred_bom_items', to='crm.partner'),
        ),
        migrations.AddField(
            model_name='billofmaterialsitem',
            name='sequence',
            field=models.IntegerField(default=1),
        ),
        migrations.AddField(
            model_name='billofmaterialsitem',
            name='substitute_products',
            field=models.ManyToManyField(blank=True, related_name='substitutable_in_boms', to='products.product'),
        ),
        migrations.AddField(
            model_name='billofmaterialsitem',
            name='total_cost',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=15),
        ),
        migrations.AddField(
            model_name='billofmaterialsitem',
            name='unit_cost',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=12),
        ),
        migrations.AddField(
            model_name='billofmaterialsitem',
            name='waste_percentage',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=5, validators=[django.core.validators.MinValueValidator(0)]),
        ),
        migrations.AddField(
            model_name='productionplan',
            name='approved_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_production_plans', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='productionplan',
            name='auto_create_work_orders',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='productionplan',
            name='consider_capacity',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='productionplan',
            name='consider_lead_times',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='productionplan',
            name='plan_type',
            field=models.CharField(choices=[('forecast', 'Forecast Based'), ('sales_order', 'Sales Order Based'), ('reorder', 'Reorder Point Based'), ('custom', 'Custom Plan')], default='forecast', max_length=20),
        ),
        migrations.AddField(
            model_name='workorder',
            name='actual_cost',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=15),
        ),
        migrations.AddField(
            model_name='workorder',
            name='assigned_to',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_work_orders', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='workorder',
            name='auto_consume_materials',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='workorder',
            name='backflush_costing',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='workorder',
            name='customer_reference',
            field=models.CharField(blank=True, max_length=255),
        ),
        migrations.AddField(
            model_name='workorder',
            name='destination_warehouse',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='wo_destination', to='inventory.warehouse'),
        ),
        migrations.AddField(
            model_name='workorder',
            name='labor_cost',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=15),
        ),
        migrations.AddField(
            model_name='workorder',
            name='material_cost',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=15),
        ),
        migrations.AddField(
            model_name='workorder',
            name='overhead_cost',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=15),
        ),
        migrations.AddField(
            model_name='workorder',
            name='planned_cost',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=15),
        ),
        migrations.AddField(
            model_name='workorder',
            name='priority',
            field=models.CharField(choices=[('low', 'Low'), ('normal', 'Normal'), ('high', 'High'), ('urgent', 'Urgent')], default='normal', max_length=10),
        ),
        migrations.AddField(
            model_name='workorder',
            name='quality_approved',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='workorder',
            name='quality_check_required',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='workorder',
            name='quality_notes',
            field=models.TextField(blank=True),
        ),
        migrations.AddField(
            model_name='workorder',
            name='quantity_planned',
            field=models.DecimalField(decimal_places=2, default=12.0, max_digits=12, validators=[django.core.validators.MinValueValidator(0)]),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='workorder',
            name='quantity_produced',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=12),
        ),
        migrations.AddField(
            model_name='workorder',
            name='quantity_rejected',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=12),
        ),
        migrations.AddField(
            model_name='workorder',
            name='quantity_remaining',
            field=models.DecimalField(decimal_places=2, default=0, max_digits=12),
        ),
        migrations.AddField(
            model_name='workorder',
            name='sales_order',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='work_orders', to='sales.salesorder'),
        ),
        migrations.AddField(
            model_name='workorder',
            name='source_warehouse',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='wo_source', to='inventory.warehouse'),
        ),
        migrations.AddField(
            model_name='workorder',
            name='wo_number',
            field=models.CharField(blank=True, max_length=100, unique=True),
        ),
        migrations.AlterField(
            model_name='billofmaterials',
            name='version',
            field=models.CharField(default='1.0', max_length=50),
        ),
        migrations.AlterField(
            model_name='billofmaterialsitem',
            name='quantity',
            field=models.DecimalField(decimal_places=2, max_digits=12, validators=[django.core.validators.MinValueValidator(0)]),
        ),
        migrations.AlterField(
            model_name='productionplan',
            name='status',
            field=models.CharField(choices=[('draft', 'Draft'), ('approved', 'Approved'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('cancelled', 'Cancelled')], default='draft', max_length=20),
        ),
        migrations.AlterField(
            model_name='workorder',
            name='actual_end',
            field=models.DateTimeField(blank=True, null=True),
        ),
        migrations.AlterField(
            model_name='workorder',
            name='actual_start',
            field=models.DateTimeField(blank=True, null=True),
        ),
        migrations.AlterField(
            model_name='workorder',
            name='scheduled_end',
            field=models.DateTimeField(blank=True, null=True),
        ),
        migrations.AlterField(
            model_name='workorder',
            name='scheduled_start',
            field=models.DateTimeField(blank=True, null=True),
        ),
        migrations.AlterField(
            model_name='workorder',
            name='status',
            field=models.CharField(choices=[('draft', 'Draft'), ('planned', 'Planned'), ('released', 'Released'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('cancelled', 'Cancelled'), ('on_hold', 'On Hold')], default='draft', max_length=20),
        ),
        migrations.AlterUniqueTogether(
            name='billofmaterials',
            unique_together={('company', 'product', 'version')},
        ),
        migrations.CreateModel(
            name='BOMOperation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('operation_name', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True)),
                ('sequence', models.IntegerField(default=1)),
                ('setup_time_minutes', models.DecimalField(decimal_places=2, default=0, max_digits=8)),
                ('run_time_per_unit_minutes', models.DecimalField(decimal_places=2, default=0, max_digits=8)),
                ('cleanup_time_minutes', models.DecimalField(decimal_places=2, default=0, max_digits=8)),
                ('operators_required', models.IntegerField(default=1)),
                ('skill_level_required', models.CharField(blank=True, max_length=50)),
                ('quality_check_required', models.BooleanField(default=False)),
                ('quality_specification', models.TextField(blank=True)),
                ('cost_per_hour', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('total_cost', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('work_instruction', models.TextField(blank=True)),
                ('safety_notes', models.TextField(blank=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('bom', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='operations', to='manufacturing.billofmaterials')),
            ],
            options={
                'ordering': ['sequence'],
            },
        ),
        migrations.CreateModel(
            name='MaterialConsumption',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('planned_quantity', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('consumed_quantity', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('waste_quantity', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('unit_cost', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('total_cost', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('consumed_at', models.DateTimeField(blank=True, null=True)),
                ('batch_number', models.CharField(blank=True, max_length=100)),
                ('expiry_date', models.DateField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('bom_item', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='consumptions', to='manufacturing.billofmaterialsitem')),
                ('consumed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='material_consumptions', to=settings.AUTH_USER_MODEL)),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='consumptions', to='products.product')),
                ('warehouse', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='material_consumptions', to='inventory.warehouse')),
                ('work_order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='material_consumptions', to='manufacturing.workorder')),
            ],
        ),
        migrations.CreateModel(
            name='MRPPlan',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255)),
                ('plan_date', models.DateField(default=django.utils.timezone.now)),
                ('planning_horizon_days', models.IntegerField(default=90)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('calculating', 'Calculating'), ('completed', 'Completed'), ('approved', 'Approved'), ('executed', 'Executed')], default='draft', max_length=20)),
                ('include_safety_stock', models.BooleanField(default=True)),
                ('include_reorder_points', models.BooleanField(default=True)),
                ('consider_lead_times', models.BooleanField(default=True)),
                ('calculation_start', models.DateTimeField(blank=True, null=True)),
                ('calculation_end', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_mrp_plans', to=settings.AUTH_USER_MODEL)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mrp_plans', to='user_auth.company')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_mrp_plans', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-plan_date'],
            },
        ),
        migrations.CreateModel(
            name='MRPRequirement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('required_quantity', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('available_quantity', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('shortage_quantity', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('required_date', models.DateField()),
                ('suggested_order_date', models.DateField(blank=True, null=True)),
                ('source_type', models.CharField(choices=[('purchase', 'Purchase'), ('manufacture', 'Manufacture'), ('transfer', 'Transfer')], max_length=20)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('ordered', 'Ordered'), ('received', 'Received'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('mrp_plan', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='requirements', to='manufacturing.mrpplan')),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mrp_requirements', to='products.product')),
                ('sales_orders', models.ManyToManyField(blank=True, related_name='mrp_requirements', to='sales.salesorder')),
                ('work_orders', models.ManyToManyField(blank=True, related_name='mrp_requirements', to='manufacturing.workorder')),
            ],
            options={
                'ordering': ['required_date', 'product__name'],
            },
        ),
        migrations.CreateModel(
            name='ProductionPlanItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('planned_quantity', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('produced_quantity', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('remaining_quantity', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('planned_start_date', models.DateField()),
                ('planned_end_date', models.DateField()),
                ('actual_start_date', models.DateField(blank=True, null=True)),
                ('actual_end_date', models.DateField(blank=True, null=True)),
                ('priority', models.CharField(choices=[('low', 'Low'), ('normal', 'Normal'), ('high', 'High'), ('urgent', 'Urgent')], default='normal', max_length=10)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='production_plan_items', to='products.product')),
                ('production_plan', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='manufacturing.productionplan')),
                ('sales_orders', models.ManyToManyField(blank=True, related_name='production_plan_items', to='sales.salesorder')),
                ('work_orders', models.ManyToManyField(blank=True, related_name='production_plan_items', to='manufacturing.workorder')),
            ],
            options={
                'ordering': ['planned_start_date', 'priority'],
            },
        ),
        migrations.CreateModel(
            name='WorkCenter',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255)),
                ('code', models.CharField(max_length=50, unique=True)),
                ('description', models.TextField(blank=True)),
                ('capacity_per_hour', models.DecimalField(decimal_places=2, default=1, max_digits=10)),
                ('cost_per_hour', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('setup_time_minutes', models.IntegerField(default=0)),
                ('cleanup_time_minutes', models.IntegerField(default=0)),
                ('operating_hours_per_day', models.DecimalField(decimal_places=2, default=8, max_digits=4)),
                ('operating_days_per_week', models.IntegerField(default=5)),
                ('requires_operator', models.BooleanField(default=True)),
                ('max_operators', models.IntegerField(default=1)),
                ('requires_quality_check', models.BooleanField(default=False)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='work_centers', to='user_auth.company')),
                ('warehouse', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='work_centers', to='inventory.warehouse')),
            ],
            options={
                'unique_together': {('company', 'code')},
            },
        ),
        migrations.CreateModel(
            name='JobCard',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('card_number', models.CharField(blank=True, max_length=100, unique=True)),
                ('work_instruction', models.TextField(blank=True)),
                ('safety_instructions', models.TextField(blank=True)),
                ('quality_requirements', models.TextField(blank=True)),
                ('tools_required', models.TextField(blank=True)),
                ('issued_at', models.DateTimeField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('issued', 'Issued'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('target_quantity', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('actual_quantity', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('rejected_quantity', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('issued_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='issued_job_cards', to=settings.AUTH_USER_MODEL)),
                ('operation', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='job_cards', to='manufacturing.bomoperation')),
                ('work_order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='job_cards', to='manufacturing.workorder')),
                ('work_center', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='job_cards', to='manufacturing.workcenter')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='bomoperation',
            name='work_center',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bom_operations', to='manufacturing.workcenter'),
        ),
        migrations.CreateModel(
            name='WorkOrderOperation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('skipped', 'Skipped')], default='pending', max_length=20)),
                ('sequence', models.IntegerField()),
                ('planned_start', models.DateTimeField(blank=True, null=True)),
                ('planned_end', models.DateTimeField(blank=True, null=True)),
                ('actual_start', models.DateTimeField(blank=True, null=True)),
                ('actual_end', models.DateTimeField(blank=True, null=True)),
                ('quantity_to_produce', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('quantity_produced', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('quantity_rejected', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('actual_cost', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assigned_operators', models.ManyToManyField(blank=True, related_name='assigned_operations', to=settings.AUTH_USER_MODEL)),
                ('bom_operation', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='work_order_operations', to='manufacturing.bomoperation')),
                ('work_center', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='manufacturing.workcenter')),
                ('work_order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='operations', to='manufacturing.workorder')),
            ],
            options={
                'ordering': ['sequence'],
                'unique_together': {('work_order', 'sequence')},
            },
        ),
        migrations.CreateModel(
            name='QualityCheck',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quality_type', models.CharField(choices=[('incoming', 'Incoming Inspection'), ('in_process', 'In-Process'), ('final', 'Final Inspection'), ('random', 'Random Sampling')], max_length=20)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('passed', 'Passed'), ('failed', 'Failed'), ('conditional', 'Conditional Pass')], default='pending', max_length=20)),
                ('inspection_date', models.DateTimeField(default=django.utils.timezone.now)),
                ('lot_size', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('sample_size', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('quantity_passed', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('quantity_failed', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('defect_description', models.TextField(blank=True)),
                ('corrective_action', models.TextField(blank=True)),
                ('specification', models.TextField(blank=True)),
                ('test_results', models.JSONField(blank=True, default=dict)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('inspector', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='quality_inspections', to=settings.AUTH_USER_MODEL)),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='quality_checks', to='products.product')),
                ('work_order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='quality_checks', to='manufacturing.workorder')),
                ('work_order_operation', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='quality_checks', to='manufacturing.workorderoperation')),
            ],
            options={
                'ordering': ['-inspection_date'],
            },
        ),
        migrations.CreateModel(
            name='OperationLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('log_type', models.CharField(choices=[('start', 'Start'), ('pause', 'Pause'), ('resume', 'Resume'), ('complete', 'Complete'), ('quality_check', 'Quality Check'), ('downtime', 'Downtime'), ('setup', 'Setup'), ('cleanup', 'Cleanup')], max_length=20)),
                ('timestamp', models.DateTimeField(default=django.utils.timezone.now)),
                ('quantity_produced', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('quantity_rejected', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('downtime_reason', models.CharField(blank=True, max_length=255)),
                ('downtime_category', models.CharField(blank=True, max_length=100)),
                ('quality_passed', models.BooleanField(blank=True, null=True)),
                ('quality_notes', models.TextField(blank=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('operator', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='operation_logs', to=settings.AUTH_USER_MODEL)),
                ('work_center', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='manufacturing.workcenter')),
                ('work_order_operation', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='logs', to='manufacturing.workorderoperation')),
            ],
            options={
                'ordering': ['-timestamp'],
            },
        ),
        migrations.AlterUniqueTogether(
            name='bomoperation',
            unique_together={('bom', 'sequence')},
        ),
    ]
